<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>í”„ë¦¬ë„¤ê°€ì¡±íŒ€ ë‚¨ê²½ ì—¬í–‰ - ì˜¨ë¼ì¸ ìˆ™ì§€í˜„í™©</title>

<!-- Tailwind CDN -->
<script src="https://cdn.tailwindcss.com"></script>

<!-- Fonts & Icons -->
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Noto+Sans+KR:wght@400;500;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">

<style>
  body{font-family:'Inter','Noto Sans KR',sans-serif;background:#f7fafc;}
  .accordion-header{cursor:pointer;}
  .accordion-header .icon{transition:transform .3s ease;}
  .accordion-header.active .icon{transform:rotate(180deg);}
  input[type=checkbox]:checked+label{text-decoration:line-through;color:#a0aec0;}
  .confirmation-table th,.confirmation-table td{text-align:center;padding:.75rem .5rem;border:1px solid #e2e8f0;font-size:.875rem}
  .confirmation-table th{background:#f8fafc;font-weight:600}
  .confirmation-table .member-name{text-align:left;font-weight:600;white-space:nowrap}
  .info-section{padding:1rem;background:#f8fafc;border-radius:8px;margin-bottom:1rem}
  .info-title{font-weight:600;color:#1e3a8a;margin-bottom:.5rem}
  .highlight-box{background:#fffbeb;border-left:4px solid #f59e0b;padding:1rem;margin-top:1rem;border-radius:4px}
  .comparison-table th,.comparison-table td{border:1px solid #e2e8f0;padding:.75rem;text-align:center;font-size:.875rem}
  .comparison-table th{background:#f1f5f9;font-weight:600}
  .hidden-important{display:none !important;} /* Day-0 mode */
</style>
</head>
<body class="bg-gray-50 text-gray-800">

<!-- ===== Firebase ì „ì—­ êµ¬ì„±ê°’ (í•„ìˆ˜) ===== -->
<script>
  const __firebase_config = JSON.stringify({
    apiKey: "AIzaSyA27iXhZPvc0w6lzaw9mGpbe2pbIWliQtc",
    authDomain: "freene-nanjing-2025.firebaseapp.com",
    projectId: "freene-nanjing-2025",
    storageBucket: "freene-nanjing-2025.firebasestorage.app",
    messagingSenderId: "106888422558",
    appId: "1:106888422558:web:429a64702973b71ecf878f",
    measurementId: "G-1NJ9PW5TF8"
  });
  const __app_id = "freene-nanjing-2025";
  const __initial_auth_token = ""; // ìµëª… ë¡œê·¸ì¸ ì‚¬ìš©
</script>

<div id="app-root" class="container mx-auto max-w-4xl p-4 sm:p-8">
  <header class="text-center mb-8">
    <h1 class="text-3xl sm:text-4xl font-bold text-blue-600">í”„ë¦¬ë„¤ê°€ì¡±íŒ€ ë‚¨ê²½ ì—¬í–‰</h1>
    <p class="text-lg text-gray-600 mt-1">ìµœì¢… ì ê²€ & ì˜¨ë¼ì¸ ìˆ™ì§€í˜„í™©</p>
    <p id="dday-widget" class="text-lg font-semibold text-red-600 mt-2"></p>
  </header>

  <!-- ì˜¨ë¼ì¸ ìˆ™ì§€ í˜„í™© í…Œì´ë¸” -->
  <div id="online-status-card" class="bg-white rounded-lg shadow-md border border-gray-200 p-5 mb-8">
    <h2 class="text-xl font-semibold text-blue-700 mb-4 text-center">
      <i class="fas fa-user-check mr-2"></i>íŒ€ì›ë³„ ìˆ™ì§€ í˜„í™©
    </h2>
    <p class="text-center text-gray-600 mb-4">
      Firestore ì‹¤ì‹œê°„ ë™ê¸°í™”. (ì¤€ë¹„ë¬¼ ê°œë³„í•­ëª©ì€ ê³µìœ ë˜ì§€ ì•ŠìŒ)
    </p>
    <div id="confirmation-container" class="overflow-x-auto">
      <p class="text-center text-gray-500">ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘â€¦</p>
    </div>
  </div>

  <!-- ì´ë¦„ ì„ íƒ í™”ë©´ -->
  <div id="login-screen" class="mb-8">
    <div class="bg-white rounded-lg shadow-md border border-gray-200 p-5 text-center">
      <h2 class="text-xl sm:text-2xl font-semibold mb-4">ë³¸ì¸ì˜ ì´ë¦„ì„ ì„ íƒí•˜ì„¸ìš”.</h2>
      <div id="name-selector" class="grid grid-cols-2 sm:grid-cols-3 gap-4"></div>
    </div>
  </div>

  <!-- ë©”ì¸ í™”ë©´ (ì´ë¦„ ì„ íƒ í›„ í‘œì‹œ) -->
  <div id="main-screen" class="space-y-4 hidden">
    <header class="flex flex-col sm:flex-row items-center justify-between gap-4 mb-4">
      <div class="text-center sm:text-left">
        <h2 class="text-2xl font-bold text-blue-600"><span id="user-name"></span>ë‹˜ í™˜ì˜í•©ë‹ˆë‹¤!</h2>
        <p class="text-md text-gray-600 mt-1">ì•„ë˜ í•­ëª©ë“¤ì„ ì½ê³  í™•ì¸ í›„ ì²´í¬í•˜ì„¸ìš”.</p>
      </div>
      <div class="flex flex-col sm:flex-row gap-2 w-full sm:w-auto">
        <button id="logout-button" class="w-full sm:w-auto bg-gray-200 hover:bg-gray-300 text-gray-700 font-semibold py-2 px-4 rounded-lg transition">
          <i class="fas fa-arrow-left mr-2"></i>ì´ë¦„ ë‹¤ì‹œ ì„ íƒ
        </button>
        <button id="reset-data-button" class="w-full sm:w-auto bg-red-500 hover:bg-red-600 text-white font-semibold py-2 px-4 rounded-lg transition">
          ë°ì´í„° ì´ˆê¸°í™”
        </button>
      </div>
    </header>

    <!-- ì˜¨ë¼ì¸ ê³µìœ  í† ê¸€ -->
    <div class="bg-white rounded-lg shadow-md border border-gray-200 p-4 flex items-center justify-between">
      <label for="online-share-toggle" class="text-sm sm:text-base font-medium text-gray-700 flex-1 text-left">
        ì´ ê¸°ê¸°ì˜ ì²´í¬ ê²°ê³¼ë¥¼ ì˜¨ë¼ì¸ í‘œì— ê³µìœ .
      </label>
      <input id="online-share-toggle" type="checkbox" class="h-5 w-5 text-blue-600 rounded border-gray-300 cursor-pointer">
    </div>

    <!-- ì„¹ì…˜ ì»¨í…Œì´ë„ˆ -->
    <div class="space-y-4" id="main-content-sections"><!-- JS inject --></div>
  </div>
</div>

<!-- ===== Firebase + App Logic ===== -->
<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
  import { getAuth, signInAnonymously, signInWithCustomToken } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
  import { getFirestore, doc, onSnapshot, setDoc, updateDoc } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

  /* ------------------ ê¸°ë³¸ êµ¬ì„± ------------------ */
  const APP_VERSION = "v4-online";
  const STORAGE_KEY = `tripPrepData-Nanjing2025-${APP_VERSION}`;

  const teamMembers = ["ê°•ë¬¸ìˆœ","ê¹€ì¤€í˜•","ê¹€í˜„ì •","ì•ˆìƒí˜„","ê¹€í˜„ì£¼","ë°•ì˜ìˆœ"];
  const sections = { plan:"ì§‘ê²°ê³„íš", info:"ì£¼ìš”ì•ˆë‚´", checklist:"ì¤€ë¹„ë¬¼", schedule:"ì¼ì •í‘œ" };

  const checklistItems = {
    docs: [
      {id:'c1',text:'ì—¬ê¶Œ (ì‚¬ë³¸ ë³„ë„ ë³´ê´€)'},
      {id:'c2',text:'í•­ê³µê¶Œ E-ticket'},
      {id:'c3',text:'í•´ì™¸ì‚¬ìš© ê°€ëŠ¥ ì‹ ìš©ì¹´ë“œ'},
      {id:'c4',text:'ìœ„ì•ˆí™” í˜„ê¸ˆ (ì†Œì•¡ê¶Œ)'}
    ],
    clothing: [
      {id:'c5',text:'ì—¬ë¦„ì˜·, í¸í•œ ì‹ ë°œ, ì†ì˜·'},
      {id:'c6',text:'ëƒ‰ë°© ëŒ€ë¹„ìš© ê²‰ì˜·'},
      {id:'c7',text:'ëª¨ì, ì„ ê¸€ë¼ìŠ¤, ìì™¸ì„  ì°¨ë‹¨ì œ'},
      {id:'c8',text:'ì ‘ëŠ” ìš°ì‚°/ì–‘ì‚° (ì„ íƒ)'}
    ],
    electronics: [
      {id:'c9',text:'ìŠ¤ë§ˆíŠ¸í°, ë³´ì¡°ë°°í„°ë¦¬'},
      {id:'c10',text:'ì¤‘êµ­ìš© ì „ì› ì–´ëŒ‘í„°'},
      {id:'c11',text:'ì¶©ì „ ì¼€ì´ë¸”, ë©€í‹°íƒ­ (ì„ íƒ)'}
    ],
    medicine: [
      {id:'c12',text:'ê°œì¸ ë³µìš©ì•½ (í•„ìˆ˜)'},
      {id:'c13',text:'ì¢…í•©ê°ê¸°ì•½, ì†Œí™”ì œ, ë°´ë“œ ë“±'},
      {id:'c14',text:'ë¹„ìƒ ê°„ì‹ (ì„ íƒ)'}
    ]
  };
  const TOTAL_CHECK_ITEMS = Object.values(checklistItems).flat().length; // 14
  const SHARE_CHECK_COUNTS = true; // ì˜¨ë¼ì¸ í‘œì— ì¤€ë¹„ë¬¼ ê°œìˆ˜ í‘œì‹œ

  /* ------------------ ì „ì—­ ìƒíƒœ ------------------ */
  let currentUser = null;
  let confirmationData = {}; // ë¡œì»¬
  let shareEnabled = false;  // ë‚´ ê¸°ê¸° ì˜¨ë¼ì¸ ê³µìœ  í† ê¸€
  let onlineData = {};       // Firestore ì‹¤ì‹œê°„ ë°ì´í„°

  /* ------------------ DOM refs ------------------ */
  const loginScreen = document.getElementById('login-screen');
  const nameSelector = document.getElementById('name-selector');
  const mainScreen  = document.getElementById('main-screen');
  const userNameSpan = document.getElementById('user-name');
  const mainContentContainer = document.getElementById('main-content-sections');
  const confirmationContainer = document.getElementById('confirmation-container');
  const logoutButton = document.getElementById('logout-button');
  const resetButton = document.getElementById('reset-data-button');
  const onlineShareToggle = document.getElementById('online-share-toggle');

  /* ------------------ ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ ------------------ */
  function initLocalData(){
    confirmationData = {};
    teamMembers.forEach(m=>{
      confirmationData[m]={};
      Object.keys(sections).forEach(k=>confirmationData[m][k]=false);
      confirmationData[m].checklist={};
        confirmationData[m].checklist_all = false; // 
      for(const cat in checklistItems){
        checklistItems[cat].forEach(it=>{
          confirmationData[m].checklist[it.id]=false;
        });
      }
    });
    saveLocalData();
  }
  function loadLocalData(){
    try{
      const raw = localStorage.getItem(STORAGE_KEY);
      if(!raw){ initLocalData(); return; }
      confirmationData = JSON.parse(raw);
    }catch(e){
      console.error('local parse fail',e);
      initLocalData();
    }
  }
  function saveLocalData(){
    try{ localStorage.setItem(STORAGE_KEY, JSON.stringify(confirmationData)); }
    catch(e){ console.error('local save fail',e); }
  }
  function resetLocal(){
    if(!confirm('ëª¨ë“  ë¡œì»¬ ì²´í¬ ìƒíƒœë¥¼ ì´ˆê¸°í™”í• ê¹Œìš”?')) return;
    localStorage.removeItem(STORAGE_KEY);
    initLocalData();
    if(currentUser) renderMainContent(currentUser);
  }

  /* ------------------ Firebase ì´ˆê¸°í™” ------------------ */
  const firebaseConfig = (()=>{
    try { return JSON.parse(__firebase_config); }
    catch(e){ return {apiKey:'DEMO',authDomain:'DEMO',projectId:'DEMO'}; }
  })();
  const appId = (typeof __app_id!=='undefined' && __app_id) ? __app_id : 'trip-prep-default';

  const app = initializeApp(firebaseConfig);
  const auth = getAuth(app);
  const db = getFirestore(app);

  // ë‹¨ì¼ ë¬¸ì„œ ê²½ë¡œ (ë¬¸ì„œë¡œ ëë‚˜ì•¼ í•¨!)
  // artifacts/{appId}/public/trip_confirmations_status
const docRef = doc(db, "artifacts", appId, "public", "status");

  async function firebaseInitAuth(){
    try{
      if(typeof __initial_auth_token!=='undefined' && __initial_auth_token){
        await signInWithCustomToken(auth, __initial_auth_token);
      }else{
        await signInAnonymously(auth);
      }
    }catch(e){
      console.error('Firebase auth error',e);
    }
  }

  /* ------------------ Firestore ì‹¤ì‹œê°„ êµ¬ë… ------------------ */
  function subscribeOnlineData(){
    onSnapshot(docRef,(snap)=>{
      if(snap.exists()){
        onlineData = snap.data();
      }else{
        // ë¬¸ì„œ ì—†ìœ¼ë©´ ì´ˆê¸° ìƒì„±
        const base={};
        teamMembers.forEach(m=>{
          base[m]={};
          Object.keys(sections).forEach(k=>base[m][k]=false);
          if(SHARE_CHECK_COUNTS){ base[m].checkCount=0; base[m].checkTotal=TOTAL_CHECK_ITEMS; }
        });
        setDoc(docRef,base).catch(e=>console.error('init doc fail',e));
        onlineData = base;
      }
      renderOnlineTable(onlineData);
    },(err)=>{
      console.error('snapshot error',err);
      confirmationContainer.innerHTML = '<p class="text-red-500 text-center">ì˜¨ë¼ì¸ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ì§€ ëª»í–ˆìŠµë‹ˆë‹¤.</p>';
    });
  }

  /* ------------------ Firestore ì—…ë°ì´íŠ¸ ------------------ */
  async function pushAllOnline(member){
    if(!shareEnabled) return;
    const counts = countChecklist(member);
    const allCl = allChecklistDone(member);
    const payload = {
      [`${member}.plan`]: !!confirmationData[member].plan,
      [`${member}.info`]: !!confirmationData[member].info,
      [`${member}.checklist`]: allCl,   // ì¤€ë¹„ë¬¼ ì „ë¶€ í™•ì¸í–ˆëŠ”ì§€
      [`${member}.schedule`]: !!confirmationData[member].schedule,
    };
    if(SHARE_CHECK_COUNTS){
      payload[`${member}.checkCount`] = counts.checked;
      payload[`${member}.checkTotal`] = counts.total;
    }
    payload["_meta"] = {updated:Date.now()};
    try{ await updateDoc(docRef,payload); }
    catch(e){ await setDoc(docRef,payload,{merge:true}); }
  }

  async function updateOnline(member,section,value){
    if(!shareEnabled) return;
    const payload={};
    payload[`${member}.${section}`]=value;
    if(section==='checklist' && SHARE_CHECK_COUNTS){
      const counts=countChecklist(member);
      payload[`${member}.checkCount`]=counts.checked;
      payload[`${member}.checkTotal`]=counts.total;
    }
    payload["_meta"]={updated:Date.now()};
    try{ await updateDoc(docRef,payload); }
    catch(e){ await setDoc(docRef,payload,{merge:true}); }
  }

  /* ------------------ ì¤€ë¹„ë¬¼ ê°œìˆ˜ ì§‘ê³„ ------------------ */
  function countChecklist(member){
    const cl = confirmationData[member]?.checklist || {};
    let c=0;
    for(const cat in checklistItems){
      checklistItems[cat].forEach(it=>{
        if(cl[it.id]) c++;
      });
    }
    return {checked:c,total:TOTAL_CHECK_ITEMS};
  }
  function allChecklistDone(member){
    const cl = confirmationData[member]?.checklist || {};
    for(const cat in checklistItems){
      for(const it of checklistItems[cat]){
        if(!cl[it.id]) return false;
      }
    }
    return true;
  }
  function setAllChecklist(member,val){
    for(const cat in checklistItems){
      for(const it of checklistItems[cat]){
        confirmationData[member].checklist[it.id]=val;
        const cb=document.getElementById(it.id);
        if(cb) cb.checked=val;
      }
    }
  }

  /* ------------------ ì˜¨ë¼ì¸ í‘œ ë Œë” ------------------ */
  function renderOnlineTable(data){
    if(!confirmationContainer) return;
    const secKeys = Object.keys(sections);
    const secNames = Object.values(sections);
    let html='<table class="w-full confirmation-table"><thead><tr><th class="member-name">íŒ€ì›</th>';
    secNames.forEach(n=>{ html += `<th>${n}</th>`; });
    if(SHARE_CHECK_COUNTS) html+='<th>ì¤€ë¹„ë¬¼(ê°œìˆ˜)</th>';
    html+='</tr></thead><tbody>';
    teamMembers.forEach(m=>{
      const row=data[m]||{};
      html+=`<tr><td class="member-name">${m}</td>`;
      secKeys.forEach(k=>{
        html+=`<td>${row[k]?'âœ”ï¸':''}</td>`;
      });
      if(SHARE_CHECK_COUNTS){
        const cc = typeof row.checkCount==='number'?row.checkCount:0;
        const tt = typeof row.checkTotal==='number'?row.checkTotal:TOTAL_CHECK_ITEMS;
        html+=`<td>${cc}/${tt}</td>`;
      }
      html+='</tr>';
    });
    html+='</tbody></table>';
    confirmationContainer.innerHTML=html;
  }

  /* ------------------ ë¡œê·¸ì¸ í™”ë©´ ë Œë” ------------------ */
  function renderLoginScreen(){
    nameSelector.innerHTML='';
    teamMembers.forEach(name=>{
      const btn=document.createElement('button');
      btn.type='button';
      btn.className='p-4 bg-blue-500 text-white font-bold rounded-lg hover:bg-blue-600 transition transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500';
      btn.textContent=name;
      btn.dataset.name=name;
      nameSelector.appendChild(btn);
    });
  }

  /* ------------------ ë©”ì¸ í™”ë©´ ë Œë” ------------------ */
  function renderMainContent(user){
    userNameSpan.textContent=user;
    mainContentContainer.innerHTML=`
      <div id="section-plan" class="accordion-item bg-white rounded-lg shadow-md border border-gray-200"></div>
      <div id="section-info" class="accordion-item bg-white rounded-lg shadow-md border border-gray-200"></div>
      <div id="section-checklist" class="accordion-item bg-white rounded-lg shadow-md border border-gray-200"></div>
      <div id="section-schedule" class="accordion-item bg-white rounded-lg shadow-md border border-gray-200"></div>
    `;
    populateContent();
    applyUserState(user);
    setupAccordion();
    applyDay0Mode();
  }

  /* ------------------ ì„¹ì…˜ ë‚´ìš© HTML ì£¼ì… ------------------ */
  function populateContent(){
    // Plan
    document.getElementById('section-plan').innerHTML=`
      <div class="accordion-header flex justify-between items-center p-5">
        <h2 class="text-xl font-semibold text-blue-700"><i class="fas fa-plane-departure mr-3"></i>ì²«ë‚  ì§‘ê²° ë° ì¶œêµ­ ê³„íš (ê°€ì¥ ì¤‘ìš”!)</h2>
        <div class="flex items-center space-x-2">
          <label for="check-plan" class="text-sm font-medium text-gray-600">í™•ì¸ì™„ë£Œ</label>
          <input type="checkbox" id="check-plan" data-section="plan" class="h-5 w-5 rounded border-gray-300 text-blue-600">
        </div>
        <i class="fas fa-chevron-down icon ml-4"></i>
      </div>
      <div class="accordion-content p-5 border-t border-gray-200">
        <div class="overflow-x-auto">
          <table class="w-full text-left border-collapse">
            <thead class="bg-blue-50">
              <tr>
                <th class="p-3 font-semibold text-sm">ì‹œê°„</th>
                <th class="p-3 font-semibold text-sm">ê³„íš</th>
                <th class="p-3 font-semibold text-sm">ì¥ì†Œ</th>
                <th class="p-3 font-semibold text-sm">ë‹´ë‹¹ ë° ë¹„ê³ </th>
              </tr>
            </thead>
            <tbody>
              <tr class="border-b"><td class="p-3">09:20</td><td class="p-3">ì „ì› ì§‘ê²° ë° ì¸ì› ì ê²€</td><td class="p-3">ì¸ì²œê³µí•­ ì œ1ì—¬ê°í„°ë¯¸ë„ 3ì¸µ Fì—´ ì•„ì‹œì•„ë‚˜í•­ê³µ ì¹´ìš´í„° ì•</td><td class="p-3">ê¹€í˜„ì • (ë¦¬ë”)</td></tr>
              <tr class="border-b"><td class="p-3">09:30</td><td class="p-3">ë‹¨ì²´ ìˆ˜ì† ë° ìˆ˜í•˜ë¬¼ ìœ„íƒ</td><td class="p-3">ì•„ì‹œì•„ë‚˜í•­ê³µ ì¹´ìš´í„°</td><td class="p-3">ì „ì› (ì—¬ê¶Œ í•„ìˆ˜ ì§€ì°¸)</td></tr>
              <tr class="border-b"><td class="p-3">10:30</td><td class="p-3">ë³´ì•ˆ ê²€ìƒ‰ ë° ì¶œêµ­ ì‹¬ì‚¬</td><td class="p-3">3ì¸µ ì¶œêµ­ì¥</td><td class="p-3">ê°œë³„ ì§„í–‰</td></tr>
              <tr class="border-b"><td class="p-3">11:00</td><td class="p-3">ë©´ì„¸êµ¬ì—­ ë‚´ ììœ ì‹œê°„ ë° ì•„ì¹¨/ì ì‹¬</td><td class="p-3">ë©´ì„¸êµ¬ì—­</td><td class="p-3">ê°œë³„ ë˜ëŠ” ê·¸ë£¹ í™œë™</td></tr>
              <tr class="border-b"><td class="p-3">11:50</td><td class="p-3">íƒ‘ìŠ¹êµ¬ ì• ì§‘ê²°</td><td class="p-3">íƒ‘ìŠ¹êµ¬ (E-ticket í™•ì¸)</td><td class="p-3 text-red-500 font-bold">ì‹œê°„ ì—„ìˆ˜</td></tr>
              <tr><td class="p-3">12:20</td><td class="p-3">ë‚¨ê²½ìœ¼ë¡œ ì¶œë°œ (OZ349)</td><td class="p-3">-</td><td class="p-3">-</td></tr>
            </tbody>
          </table>
        </div>
      </div>`;

    // Info
document.getElementById('section-info').innerHTML = `
    <div class="accordion-header flex justify-between items-center p-5">
        <h2 class="text-xl font-semibold text-blue-700"><i class="fas fa-info-circle mr-3"></i>ì—¬í–‰ ì¤‘ ì£¼ìš” ì•ˆë‚´ì‚¬í•­</h2>
        <div class="flex items-center space-x-2">
            <label for="check-info" class="text-sm font-medium text-gray-600">í™•ì¸ì™„ë£Œ</label>
            <input type="checkbox" id="check-info" data-section="info" class="h-5 w-5 rounded border-gray-300 text-blue-600">
        </div>
        <i class="fas fa-chevron-down icon ml-4"></i>
    </div>
    <div class="accordion-content p-5 border-t border-gray-200 space-y-4">
        <div class="info-section">
            <h4 class="info-title"><i class="fas fa-users-cog mr-2"></i>ì£¼ìš” ë‹´ë‹¹ì ì•ˆë‚´</h4>
            <ul class="list-disc list-inside ml-4 space-y-2 text-gray-700">
                <li><strong>ì´ê´„ ë¦¬ë”: ê¹€í˜„ì •</strong> â€“ ì „ì²´ ì¼ì •, ê°€ì´ë“œ ì†Œí†µ, ê³µë™ê²½ë¹„.</li>
                <li><strong>í†µì‹ /ê¸°ìˆ  ì§€ì›: ì•ˆìƒí˜„</strong> â€“ ë¡œë°/ìœ ì‹¬, ê²°ì œ ì•±, ìŠ¤ë§ˆíŠ¸í° ë¬¸ì œ ë„ì›€.</li>
                <li><strong>ê±´ê°• ë‹´ë‹¹: ê¹€í˜„ì£¼</strong> â€“ ê³µìš© êµ¬ê¸‰ì•½, ê±´ê°• ê´€ë ¨ ì§€ì›.</li>
            </ul>
        </div>
        <div class="info-section">
            <h4 class="info-title"><i class="fas fa-walking mr-2"></i>ê±´ê°• ë° ì²´ë ¥ ê´€ë¦¬</h4>
            <p>2ì¼ì°¨, 3ì¼ì°¨ëŠ” ë„ë³´ ì´ë™ì´ ë§ê³  7ì›” ë§ ë‚¨ê²½ ë‚ ì”¨ëŠ” ë§¤ìš° ë”ìš¸ ê²ƒìœ¼ë¡œ ì˜ˆìƒë˜ë‹ˆ, í¸í•œ ì‹ ë°œê³¼ ê°€ë²¼ìš´ ì˜·ì°¨ë¦¼ì€ í•„ìˆ˜ì…ë‹ˆë‹¤. ì–´ë¥´ì‹ ë“¤ì˜ ì»¨ë””ì…˜ì„ ê³ ë ¤í•˜ì—¬ ê°€ì´ë“œì—ê²Œ ë™ì„  ì¡°ì •ì„ ìš”ì²­í–ˆìœ¼ë©°, í•˜ë£¨ 1~2íšŒ ì¹´í˜ íœ´ì‹ ì‹œê°„ì„ ê°€ì§ˆ ì˜ˆì •ì…ë‹ˆë‹¤.</p>
        </div>
        <div class="info-section">
            <h4 class="info-title"><i class="fas fa-utensils mr-2"></i>ì‹ì‚¬ ë° ë¹„ìƒ ì‹ëŸ‰</h4>
            <p>ì—¬í–‰ ì¤‘ 1íšŒ í•œì‹ë‹¹ì„ ì´ìš©í•  ì˜ˆì •ì…ë‹ˆë‹¤. ê·¸ ì™¸ í˜„ì§€ ìŒì‹ì´ ì…ë§›ì— ë§ì§€ ì•Šì„ ê²½ìš°ë¥¼ ëŒ€ë¹„í•˜ì—¬, ë¹„ìƒ ì‹ëŸ‰(ê¹€, ê¹€ì¹˜, ì»µë¼ë©´, í–‡ë°˜ ë“±)ì„ ì¤€ë¹„í–ˆìŠµë‹ˆë‹¤. (ë‹´ë‹¹: ê¹€í˜„ì •)</p>
        </div>
        <div class="info-section">
            <h4 class="info-title"><i class="fas fa-wifi mr-2"></i>ì¸í„°ë„· ì‚¬ìš©: ë¡œë° vs í˜„ì§€ ìœ ì‹¬</h4>
            <p class="mb-4 text-sm">ì¤‘êµ­ í˜„ì§€ì—ì„œ ì¸í„°ë„· ì‚¬ìš© ì‹œ, **êµ­ì œ ë¡œë°**ê³¼ **í˜„ì§€ ìœ ì‹¬(eSIM)** ì¤‘ ê°œì¸ì˜ í•„ìš”ì— ë§ê²Œ ììœ ë¡­ê²Œ ì„ íƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì•„ë˜ì˜ ì¥ë‹¨ì ì„ ê³ ë ¤í•˜ì—¬ ì„ íƒí•´ì£¼ì„¸ìš”.</p>
            <table class="w-full border-collapse text-left">
                <thead class="bg-gray-100">
                    <tr>
                        <th class="w-1/6 border p-3 font-semibold">êµ¬ë¶„</th>
                        <th class="w-5/12 border p-3 font-semibold">í˜„ì§€ ìœ ì‹¬ / eSIM</th>
                        <th class="w-5/12 border p-3 font-semibold">êµ­ì œ ë¡œë° (í•œêµ­ ìœ ì‹¬)</th>
                    </tr>
                </thead>
                <tbody>
                    <tr class="align-top">
                        <td class="border bg-green-50 p-4 font-bold text-green-800">ì¥ì  ğŸ‘</td>
                        <td class="border p-4"><ul class="list-disc list-inside space-y-2 text-sm"><li>ë°ì´í„° ìš”ê¸ˆì´ ë§¤ìš° ì €ë ´í•˜ê³  ë„¤íŠ¸ì›Œí¬ê°€ ì•ˆì •ì </li><li>ë°”ì´ë‘, ìœ„ì±— ë“± í˜„ì§€ ì•± ì‚¬ìš©ì— ìš©ì´</li></ul></td>
                        <td class="border p-4"><ul class="list-disc list-inside space-y-2 text-sm"><li>VPN ì—†ì´ Gmail, ì¹´ì¹´ì˜¤í†¡, ì¸ìŠ¤íƒ€ ë“± ì¦‰ì‹œ ì‚¬ìš© ê°€ëŠ¥</li><li>í•œêµ­ ë²ˆí˜¸ë¥¼ ê·¸ëŒ€ë¡œ ì‚¬ìš©í•´ ì¸ì¦ ë° ì—°ë½ì´ í¸ë¦¬</li><li>ì„¤ì •ì´ ê°„í¸í•˜ê³  ë³„ë„ì˜ ìš°íšŒ ì‘ì—…ì´ ë¶ˆí•„ìš”</li></ul></td>
                    </tr>
                    <tr class="align-top">
                        <td class="border bg-red-50 p-4 font-bold text-red-800">ë‹¨ì  ğŸ‘</td>
                        <td class="border p-4"><ul class="list-disc list-inside space-y-2 text-sm"><li>Gmail, ì¹´ì¹´ì˜¤í†¡ ë“± ëŒ€ë¶€ë¶„ì˜ í•œêµ­/í•´ì™¸ ì„œë¹„ìŠ¤ëŠ” <strong>ìœ ë£Œ VPNì„ ì„¤ì¹˜í•´ì•¼ë§Œ ì‚¬ìš© ê°€ëŠ¥</strong></li><li>ìµœê·¼ VPN ë‹¨ì†ìœ¼ë¡œ ì¼ë¶€ ì„œë¹„ìŠ¤ê°€ ë¶ˆì•ˆì •í•  ìˆ˜ ìˆìŒ</li><li>ë¬´ë£Œ VPNì€ ë³´ì•ˆ ìœ„í—˜ì´ í¬ê³  ì ‘ì† ë° ì†ë„ ë³´ì¥ì´ ì–´ë ¤ì›€</li></ul></td>
                        <td class="border p-4"><ul class="list-disc list-inside space-y-2 text-sm"><li>ìš”ê¸ˆì´ ë¹„ìŒˆ (ì¼ 1~2ë§Œì›ëŒ€ ë˜ëŠ” ì œí•œì ì¸ ë¬´ì œí•œ ì˜µì…˜)</li><li>ë°ì´í„° ì‚¬ìš©ëŸ‰ì´ë‚˜ ì†ë„ì— ì œí•œì´ ìˆì„ ìˆ˜ ìˆìŒ</li></ul></td>
                    </tr>
                </tbody>
            </table>
        </div>
        <div class="info-section">
            <h4 class="info-title"><i class="fas fa-money-bill-wave mr-2"></i>ê°œì¸ ê²½ë¹„ ë° ì¤‘êµ­ í˜„ì§€ ê²°ì œ ë°©ë²•</h4>
            <p class="mb-2">ì—¬í–‰ê²½ë¹„ ëŒ€ë¶€ë¶„ì€ ì´ë¯¸ ì§€ë¶ˆë˜ì—ˆìŠµë‹ˆë‹¤. í˜„ì§€ì—ì„œ í•„ìš”í•œ ê°œì¸ ê²½ë¹„ëŠ” <strong>ê°œì¸ ì‡¼í•‘, ê°„ì‹, ì„ íƒì  ê°€ì´ë“œ/ê¸°ì‚¬ë‹˜ íŒ</strong> ì •ë„ì…ë‹ˆë‹¤.</p>
            <p class="mb-4">ì¤‘êµ­ì€ QR ê²°ì œê°€ í¸ë¦¬í•©ë‹ˆë‹¤. ë„¤ì´ë²„í˜ì´(ì¶©ì „) + ì•Œë¦¬í˜ì´(ì‹ ìš©ì¹´ë“œ ì—°ë™) ì¡°í•©ì„ ì¶”ì²œí•©ë‹ˆë‹¤.</p>
            <div class="p-4 border rounded-md mb-3">
                <h5 class="font-semibold text-lg text-green-600">ë°©ë²• 1. ë„¤ì´ë²„í˜ì´ (í˜„ê¸ˆ ì¶©ì „)</h5>
                <p class="text-sm text-gray-600 mt-1">ê°€ê²Œ QR ì´¬ì˜ í›„ ë°”ë¡œ ê²°ì œ. ë¯¸ë¦¬ ë¨¸ë‹ˆ ì¶©ì „.</p>
            </div>
            <div class="p-4 border rounded-md">
                <h5 class="font-semibold text-lg text-blue-600">ë°©ë²• 2. ì•Œë¦¬í˜ì´ (í•´ì™¸ê²°ì œ ì¹´ë“œ)</h5>
                <p class="text-sm text-gray-600 mt-1">í•´ì™¸ì‚¬ìš© ê°€ëŠ¥ ì‹ ìš©ì¹´ë“œ ë“±ë¡. ë„¤ì´ë²„í˜ì´ ì•ˆ ë˜ëŠ” ê³³ì—ì„œ ìœ ìš©.</p>
            </div>
            <div class="highlight-box">
                <p class="font-bold text-center text-lg">ì–´ë ¤ìš°ì‹ ê°€ìš”? ê±±ì • ë§ˆì„¸ìš”!</p>
                <p class="text-center mt-2 text-gray-700">ì¤€ë¹„ê°€ ì–´ë ¤ìš°ì‹  ë¶„ë“¤ì€ <strong>ì¶œêµ­ ë‹¹ì¼ ê³µí•­ì—ì„œ ë‹´ë‹¹ì(ì•ˆìƒí˜„)ê°€ ë„ì™€ë“œë¦´ ì˜ˆì •</strong>ì…ë‹ˆë‹¤. ìŠ¤ë§ˆíŠ¸í°ê³¼ ì‹ ìš©ì¹´ë“œë§Œ ì˜ ì±™ê²¨ì˜¤ì„¸ìš”. ë‹¨, ë‹¹ì¼ì˜ í˜¼ì¡ë„ë¥¼ ê³ ë ¤í•˜ì—¬ ë„¤ì´ë²„í˜ì´ ì•±ì„ ë¯¸ë¦¬ ì„¤ì¹˜í•˜ê³  ì¶©ì „í•´ë‘ì‹œëŠ” ê²ƒì„ ê°€ì¥ ì¶”ì²œë“œë¦½ë‹ˆë‹¤.</p>
            </div>
        </div>
        <div class="info-section">
            <h4 class="info-title"><i class="fas fa-shield-alt mr-2"></i>ì•ˆì „ ë° ê¸°íƒ€ ìœ ì˜ì‚¬í•­</h4>
            <ul class="list-disc list-inside ml-4 mt-2 space-y-2 text-gray-700">
                <li><strong>ì†Œì§€í’ˆ ê´€ë¦¬:</strong> ì‚¬ëŒì´ ë§ì€ ê³³ì—ì„œ ì†Œë§¤ì¹˜ê¸° ì£¼ì˜. ì—¬ê¶ŒÂ·í˜„ê¸ˆ ì•ˆì „ ë³´ê´€.</li>
                <li><strong>ë¹„ìƒì‹œ ëŒ€ì²˜:</strong> ê°€ì´ë“œ/ìˆ™ì†Œ ì—°ë½ì²˜ ì†Œì§€, ì—¬ê¶Œ ì‚¬ë³¸(ì‚¬ì§„) íœ´ëŒ€ì „í™” ì €ì¥.</li>
                <li><strong>ë‹¨ì²´ í–‰ë™:</strong> ê°€ì´ë“œ ì•ˆë‚´ì— ë”°ë¼ í•¨ê»˜ ì´ë™. ëŒë°œ ë‹¨ë… í–‰ë™ ìì œ.</li>
            </ul>
        </div>
    </div>`;

    // Checklist
    let clHTML=`
      <div class="accordion-header flex justify-between items-center p-5">
        <h2 class="text-xl font-semibold text-blue-700"><i class="fas fa-list-check mr-3"></i>ì¤€ë¹„ë¬¼ ì²´í¬ë¦¬ìŠ¤íŠ¸</h2>
        <div class="flex items-center space-x-2">
          <label for="check-checklist" class="text-sm font-medium text-gray-600">ëª¨ë‘ í™•ì¸</label>
          <input type="checkbox" id="check-checklist" data-section="checklist" class="h-5 w-5 rounded border-gray-300 text-blue-600">
        </div>
        <i class="fas fa-chevron-down icon ml-4"></i>
      </div>
      <div class="accordion-content p-5 border-t border-gray-200 grid grid-cols-1 md:grid-cols-2 gap-6">`;
    const cats={docs:'ì„œë¥˜/ê¸ˆìœµ',clothing:'ì˜ë¥˜/ìƒí™œ',electronics:'ì „ìê¸°ê¸°',medicine:'ìƒë¹„ì•½/ê¸°íƒ€'};
    for(const cat in checklistItems){
      clHTML+=`<div><h4 class="font-bold mb-2">${cats[cat]}</h4><ul class="space-y-2">`;
      checklistItems[cat].forEach(it=>{
        clHTML+=`<li><input type="checkbox" id="${it.id}" data-section="checklist" data-item="${it.id}" class="h-4 w-4 rounded border-gray-300 text-blue-600"><label for="${it.id}" class="ml-2">${it.text}</label></li>`;
      });
      clHTML+='</ul></div>';
    }
    clHTML+='</div>';
    document.getElementById('section-checklist').innerHTML=clHTML;

 // Schedule
document.getElementById('section-schedule').innerHTML = `
    <div class="accordion-header flex justify-between items-center p-5">
        <h2 class="text-xl font-semibold text-blue-700"><i class="fas fa-calendar-alt mr-3"></i>3ë°• 4ì¼ ì„¸ë¶€ ì¼ì •í‘œ</h2>
        <div class="flex items-center space-x-2">
            <label for="check-schedule" class="text-sm font-medium text-gray-600">í™•ì¸ì™„ë£Œ</label>
            <input type="checkbox" id="check-schedule" data-section="schedule" class="h-5 w-5 rounded border-gray-300 text-blue-600">
        </div>
        <i class="fas fa-chevron-down icon ml-4"></i>
    </div>
    <div class="accordion-content p-5 border-t border-gray-200">
        <div class="space-y-6">

            <div class="p-5 border rounded-lg bg-white shadow-sm">
                <h3 class="text-lg font-bold text-blue-700 mb-4">1ì¼ì°¨ (7/26, í† ): ë‚¨ê²½ ë„ì°© ë° ì˜›ê±°ë¦¬ íƒë°©</h3>
                <div class="relative pl-20">
                    <div class="absolute left-3 top-1 bottom-1 w-0.5 bg-gray-200"></div>

                    <div class="relative mb-5">
                        <div class="absolute left-[-2.1rem] top-1 w-10 h-10 bg-red-500 text-white rounded-full flex items-center justify-center ring-4 ring-white">
                            <i class="fas fa-users"></i>
                        </div>
                        <p class="font-semibold text-gray-800">09:20 - ì¸ì²œê³µí•­ ì§‘ê²°</p>
                        <p class="text-sm text-gray-600">ì œ1ì—¬ê°í„°ë¯¸ë„ 3ì¸µ Fì—´, ë‹¨ì²´ ìˆ˜ì†</p>
                        <span class="text-xs font-semibold text-red-600 bg-red-100 px-2 py-1 rounded-full">ì‹œê°„ ì—„ìˆ˜!</span>
                    </div>
                    <div class="relative mb-5">
                        <div class="absolute left-[-2.1rem] top-1 w-10 h-10 bg-blue-500 text-white rounded-full flex items-center justify-center ring-4 ring-white">
                            <i class="fas fa-plane-departure"></i>
                        </div>
                        <p class="font-semibold text-gray-800">12:20 - ë‚¨ê²½ìœ¼ë¡œ ì¶œë°œ (OZ349)</p>
                        <p class="text-sm text-gray-600">ê³µí•­ì—ì„œ ì ì‹¬ ì‹ì‚¬ ê¶Œì¥ (ë¹„í–‰ì‹œê°„ ì•½ 2ì‹œê°„)</p>
                    </div>
                    <div class="relative mb-5">
                        <div class="absolute left-[-2.1rem] top-1 w-10 h-10 bg-green-500 text-white rounded-full flex items-center justify-center ring-4 ring-white">
                            <i class="fas fa-camera-retro"></i>
                        </div>
                        <p class="font-semibold text-gray-800">ì˜¤í›„ - êµë¶€ì˜, ë¶€ìë¬˜ ì˜›ê±°ë¦¬ ê´€ê´‘</p>
                        <p class="text-sm text-gray-600">ë‚¨ê²½ì˜ ì—­ì‚¬ì™€ ë¬¸í™”ë¥¼ ëŠë‚„ ìˆ˜ ìˆëŠ” ëŒ€í‘œ ëª…ì†Œ ë°©ë¬¸</p>
                    </div>
                    <div class="relative mb-5">
                        <div class="absolute left-[-2.1rem] top-1 w-10 h-10 bg-yellow-500 text-white rounded-full flex items-center justify-center ring-4 ring-white">
                            <i class="fas fa-utensils"></i>
                        </div>
                        <p class="font-semibold text-gray-800">ì €ë… ì‹ì‚¬ (í˜„ì§€ì‹)</p>
                    </div>
                    <div class="relative">
                        <div class="absolute left-[-2.1rem] top-1 w-10 h-10 bg-purple-500 text-white rounded-full flex items-center justify-center ring-4 ring-white">
                            <i class="fas fa-bed"></i>
                        </div>
                        <p class="font-semibold text-gray-800">í˜¸í…” ì²´í¬ì¸ ë° íœ´ì‹</p>
                    </div>
                </div>
            </div>

            <div class="p-5 border rounded-lg bg-white shadow-sm">
                <h3 class="text-lg font-bold text-blue-700 mb-4">2ì¼ì°¨ (7/27, ì¼): ì•„í”ˆ ì—­ì‚¬ì™€ ë§ˆì£¼í•˜ê¸°</h3>
                <div class="relative pl-14">
                    <div class="absolute left-3 top-1 bottom-1 w-0.5 bg-gray-200"></div>
                    <div class="relative mb-5">
                        <div class="absolute left-[-2.1rem] top-1 w-10 h-10 bg-slate-600 text-white rounded-full flex items-center justify-center ring-4 ring-white">
                            <i class="fas fa-monument"></i>
                        </div>
                        <p class="font-semibold text-gray-800">ì˜¤ì „ - ë‚¨ê²½ëŒ€í•™ì‚´ê¸°ë…ê´€, ìœ„ì•ˆë¶€ ë°•ë¬¼ê´€</p>
                        <p class="text-sm text-gray-600">ìŠì§€ ë§ì•„ì•¼ í•  ì—­ì‚¬ì˜ í˜„ì¥ ë°©ë¬¸</p>
                    </div>
                    <div class="relative mb-5">
                        <div class="absolute left-[-2.1rem] top-1 w-10 h-10 bg-teal-500 text-white rounded-full flex items-center justify-center ring-4 ring-white">
                            <i class="fas fa-landmark"></i>
                        </div>
                        <p class="font-semibold text-gray-800">ì˜¤í›„ - ì¤‘ì‚°ë¦‰, ëª…íš¨ë¦‰ ê´€ê´‘</p>
                        <p class="text-sm text-gray-600">ì¤‘êµ­ì˜ ê·¼ëŒ€ì‚¬ì™€ ëª…ë‚˜ë¼ ì‹œëŒ€ì˜ ì›…ì¥í•¨ ì²´í—˜</p>
                    </div>
                    <div class="relative mb-5">
                        <div class="absolute left-[-2.1rem] top-1 w-10 h-10 bg-cyan-500 text-white rounded-full flex items-center justify-center ring-4 ring-white">
                            <i class="fas fa-spa"></i>
                        </div>
                        <p class="font-semibold text-gray-800">ì €ë… - ì „ì‹  ë§ˆì‚¬ì§€ ì²´í—˜</p>
                        <p class="text-sm text-gray-600">í•˜ë£¨ì˜ í”¼ë¡œë¥¼ í‘¸ëŠ” ì‹œê°„</p>
                    </div>
                    <div class="relative">
                        <div class="absolute left-[-2.1rem] top-1 w-10 h-10 bg-yellow-500 text-white rounded-full flex items-center justify-center ring-4 ring-white">
                            <i class="fas fa-utensils"></i>
                        </div>
                        <p class="font-semibold text-gray-800">ì €ë… ì‹ì‚¬ (í˜„ì§€ì‹)</p>
                    </div>
                </div>
            </div>

            <div class="p-5 border rounded-lg bg-white shadow-sm">
                <h3 class="text-lg font-bold text-blue-700 mb-4">3ì¼ì°¨ (7/28, ì›”): ìì—°ê³¼ ë„ì‹¬ ì† íë§</h3>
                <div class="relative pl-14">
                    <div class="absolute left-3 top-1 bottom-1 w-0.5 bg-gray-200"></div>
                    <div class="relative mb-5">
                        <div class="absolute left-[-2.1rem] top-1 w-10 h-10 bg-green-600 text-white rounded-full flex items-center justify-center ring-4 ring-white">
                            <i class="fas fa-mountain"></i>
                        </div>
                        <p class="font-semibold text-gray-800">ì˜¤ì „ - ìš°ìˆ˜ì‚° ê´€ê´‘</p>
                        <p class="text-sm text-gray-600">ì•„ë¦„ë‹¤ìš´ ìì—° ê²½ê´€ê³¼ ë¶ˆêµ ë¬¸í™” íƒë°©</p>
                    </div>
                    <div class="relative mb-5">
                        <div class="absolute left-[-2.1rem] top-1 w-10 h-10 bg-sky-500 text-white rounded-full flex items-center justify-center ring-4 ring-white">
                            <i class="fas fa-flag"></i>
                        </div>
                        <p class="font-semibold text-gray-800">ì˜¤í›„ - ë”ì§€í”Œë¼ì, ë…ë¦½êµ° ë³¸ë¶€ í„°</p>
                        <p class="text-sm text-gray-600">ë‚¨ê²½ì˜ í˜„ëŒ€ì ì¸ ëª¨ìŠµê³¼ ëŒ€í•œë¯¼êµ­ ì„ì‹œì •ë¶€ì˜ ë°œìì·¨</p>
                    </div>
                    <div class="relative mb-5">
                        <div class="absolute left-[-2.1rem] top-1 w-10 h-10 bg-indigo-500 text-white rounded-full flex items-center justify-center ring-4 ring-white">
                            <i class="fas fa-ship"></i>
                        </div>
                        <p class="font-semibold text-gray-800">ì €ë… - í˜„ë¬´ê³µì›(ë±ƒë†€ì´)</p>
                        <p class="text-sm text-gray-600">í˜¸ìˆ˜ ìœ„ì—ì„œ ì¦ê¸°ëŠ” ë‚¨ê²½ì˜ ì•¼ê²½</p>
                    </div>
                    <div class="relative">
                        <div class="absolute left-[-2.1rem] top-1 w-10 h-10 bg-yellow-500 text-white rounded-full flex items-center justify-center ring-4 ring-white">
                            <i class="fas fa-utensils"></i>
                        </div>
                        <p class="font-semibold text-gray-800">ì €ë… ì‹ì‚¬ (í˜„ì§€ì‹)</p>
                    </div>
                </div>
            </div>

            <div class="p-5 border rounded-lg bg-white shadow-sm">
                <h3 class="text-lg font-bold text-blue-700 mb-4">4ì¼ì°¨ (7/29, í™”): ë§ˆì§€ë§‰ ì—¬ì • ê·¸ë¦¬ê³  ë³µê·€</h3>
                <div class="relative pl-14">
                    <div class="absolute left-3 top-1 bottom-1 w-0.5 bg-gray-200"></div>
                    <div class="relative mb-5">
                        <div class="absolute left-[-2.1rem] top-1 w-10 h-10 bg-orange-500 text-white rounded-full flex items-center justify-center ring-4 ring-white">
                            <i class="fas fa-archway"></i>
                        </div>
                        <p class="font-semibold text-gray-800">ì˜¤ì „ - ë‚¨ê²½ ì¤‘í™”ë¬¸ ê´€ê´‘</p>
                        <p class="text-sm text-gray-600">ê²¬ê³ í•œ ì„±ë²½ì„ ê±°ë‹ë©° ì—¬í–‰ ë§ˆë¬´ë¦¬</p>
                    </div>
                    <div class="relative mb-5">
                        <div class="absolute left-[-2.1rem] top-1 w-10 h-10 bg-blue-500 text-white rounded-full flex items-center justify-center ring-4 ring-white">
                            <i class="fas fa-plane-departure"></i>
                        </div>
                        <p class="font-semibold text-gray-800">ì˜¤í›„ - ë‚¨ê²½ ê³µí•­ìœ¼ë¡œ ì´ë™ ë° ì¶œêµ­</p>
                    </div>
                    <div class="relative">
                        <div class="absolute left-[-2.1rem] top-1 w-10 h-10 bg-gray-700 text-white rounded-full flex items-center justify-center ring-4 ring-white">
                            <i class="fas fa-house-chimney"></i>
                        </div>
                        <p class="font-semibold text-gray-800">ì €ë… - ì¸ì²œ ë„ì°©</p>
                        <p class="text-sm text-gray-600">ëª¨ë“  ì¼ì • ì¢…ë£Œ, í•´ì‚°</p>
                    </div>
                </div>
            </div>

        </div>
    </div>`;
  }
/* ------------------ ì‚¬ìš©ì ìƒíƒœ ì ìš© ------------------ */
function applyUserState(user) {
    const ud = confirmationData[user] || {};
    Object.keys(sections).forEach(k => {
        const el = document.getElementById(`check-${k}`);
        if (el) {
            // 'ì¤€ë¹„ë¬¼' ì„¹ì…˜ì€ checklist_all ê°’ì„ ì‚¬ìš©í•˜ê³ , ë‚˜ë¨¸ì§€ëŠ” ì›ë˜ëŒ€ë¡œ ì‚¬ìš©
            if (k === 'checklist') {
                el.checked = !!ud.checklist_all; // userDataê°€ ì•„ë‹ˆë¼ udë¥¼ ì‚¬ìš©
            } else {
                el.checked = !!ud[k]; // userDataê°€ ì•„ë‹ˆë¼ udë¥¼ ì‚¬ìš©
            }
        }
    });
    // ê°œë³„ ì¤€ë¹„ë¬¼
    document.querySelectorAll('#section-checklist input[type=checkbox][data-item]').forEach(cb => cb.checked = false);
    if (ud.checklist) {
        for (const cat in checklistItems) {
            checklistItems[cat].forEach(it => {
                const cb = document.getElementById(it.id);
                if (cb) cb.checked = !!ud.checklist[it.id];
            });
        }
    }
}

  /* ------------------ ì´ë²¤íŠ¸ ë¬¶ê¸° ------------------ */
  function setupGlobalEvents(){
    // ì´ë¦„ ì„ íƒ
    nameSelector.addEventListener('click',e=>{
      if(e.target.tagName!=='BUTTON') return;
      currentUser=e.target.dataset.name;
      loginScreen.classList.add('hidden');
      mainScreen.classList.remove('hidden');
      renderMainContent(currentUser);
    });

    // ë¡œê·¸ì•„ì›ƒ
    logoutButton.addEventListener('click',()=>{
      currentUser=null;
      mainScreen.classList.add('hidden');
      loginScreen.classList.remove('hidden');
    });

    // ë¡œì»¬ ì´ˆê¸°í™”
    resetButton.addEventListener('click',resetLocal);

    // ì˜¨ë¼ì¸ ê³µìœ  í† ê¸€
    onlineShareToggle.addEventListener('change',()=>{
      shareEnabled=onlineShareToggle.checked;
      if(shareEnabled && currentUser){
        pushAllOnline(currentUser);
      }
    });

    // ë©”ì¸ ì»¨í…ì¸  ì²´í¬ ë¸ë¦¬ê²Œì´ì…˜
    mainContentContainer.addEventListener('change',e=>{
      if(e.target.tagName!=='INPUT' || e.target.type!=='checkbox') return;
      if(!currentUser) return;
      const section=e.target.dataset.section;
      const itemId=e.target.dataset.item||null;
      const checked=e.target.checked;
      updateLocalState(currentUser,section,checked,itemId);
      if(section && !itemId){
        updateOnline(currentUser,section,checked);
      }else if(itemId){
        if(shareEnabled) pushAllOnline(currentUser); // ìˆ˜ëŸ‰ ë°˜ì˜
      }
    });
  }

/* ------------------ ë¡œì»¬ ìƒíƒœ ê°±ì‹  ------------------ */
function updateLocalState(user, section, checked, itemId = null) {
    if (!confirmationData[user]) confirmationData[user] = { checklist: {} };
    if (itemId) { // ê°œë³„ ì¤€ë¹„ë¬¼ í•­ëª©
        confirmationData[user].checklist[itemId] = checked;
        const allDone = allChecklistDone(user);
        confirmationData[user].checklist_all = allDone; // 'ëª¨ë‘ í™•ì¸' ìƒíƒœ ì—…ë°ì´íŠ¸
        const secBox = document.getElementById('check-checklist');
        if (secBox) secBox.checked = allDone;
    } else { // ì„¹ì…˜ ì „ì²´
        if (section === 'checklist') {
            confirmationData[user].checklist_all = checked; // 'ëª¨ë‘ í™•ì¸' ìƒíƒœë§Œ ë³€ê²½
            setAllChecklist(user, checked); // ê°œë³„ í•­ëª©ë“¤ ìƒíƒœë„ ë³€ê²½
        } else {
            confirmationData[user][section] = checked;
        }
    }
    saveLocalData();
}

  /* ------------------ ì•„ì½”ë””ì–¸ ------------------ */
  function setupAccordion(){
    const items=document.querySelectorAll('.accordion-item');
    items.forEach(it=>{
      const header=it.querySelector('.accordion-header');
      const content=it.querySelector('.accordion-content');
      if(!header||!content) return;
      header.addEventListener('click',e=>{
        if(e.target.tagName==='INPUT'||e.target.tagName==='LABEL') return;
        const active=header.classList.toggle('active');
        content.style.display=active?'block':'none';
      });
    });
    // ì²« ì„¹ì…˜ ì˜¤í”ˆ
    const firstHeader=items[0]?.querySelector('.accordion-header');
    const firstContent=items[0]?.querySelector('.accordion-content');
    if(firstHeader && firstContent){
      firstHeader.classList.add('active');
      firstContent.style.display='block';
    }
  }

  /* ------------------ D-Day ìœ„ì ¯ ------------------ */
  function renderDDay(){
    const target=new Date('2025-07-26T00:00:00+09:00');
    const today=new Date();
    const d=Math.ceil((target.setHours(0,0,0,0)-today.setHours(0,0,0,0))/86400000);
    const el=document.getElementById('dday-widget');
    if(!el) return;
    if(d>0) el.textContent=`D-${d} (ì¶œêµ­ê¹Œì§€ ${d}ì¼)`;
    else if(d===0) el.textContent='ì˜¤ëŠ˜ ì¶œêµ­! (D-Day)';
    else el.textContent=`D+${Math.abs(d)}`;
  }

  /* ------------------ Day-0 ëª¨ë“œ ------------------ */
  function applyDay0Mode(){
    const urlFlag=new URL(location.href).searchParams.get('mode')==='day0';
    const today=new Date();
    const isDay0=(today.getFullYear()===2025 && today.getMonth()===6 && today.getDate()===26);
    if(!urlFlag && !isDay0) return;
    ['section-info','section-checklist','section-schedule'].forEach(id=>{
      document.getElementById(id)?.classList.add('hidden-important');
    });
    const root=document.getElementById('app-root');
    const banner=document.createElement('div');
    banner.className='mb-4 p-3 rounded-md bg-blue-600 text-white text-center';
    banner.textContent='ì¶œêµ­ ë‹¹ì¼ ëª¨ë“œ: ê°€ì¥ ì¤‘ìš”í•œ ì§‘ê²° ì •ë³´ë§Œ í‘œì‹œ ì¤‘';
    root.insertBefore(banner,root.firstChild);
  }

  /* ------------------ main ------------------ */
  async function main(){
    loadLocalData();
    renderLoginScreen();
    setupGlobalEvents();
    renderDDay();
    await firebaseInitAuth();
    subscribeOnlineData();
  }

  document.addEventListener('DOMContentLoaded',main);
</script>
</body>
</html>
